<!DOCTYPE html>
<html lang="ar">
  <head>
    <meta charset="UTF-8" />
    <title>صور بالحجم الأصلي في PDF</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  </head>
  <body>
    <h2>اختر الصور (PNG)</h2>
    <input type="file" id="fileInput" multiple accept="image/png" />
    <br /><br />
    <button onclick="generatePDF()">تحميل PDF</button>

    <script>
      async function generatePDF() {
        const { jsPDF } = window.jspdf;
        const input = document.getElementById("fileInput");
        const files = input.files;

        if (files.length === 0) {
          alert("من فضلك اختر الصور أولاً");
          return;
        }

        let pdf;
        for (let i = 0; i < files.length; i++) {
          const file = files[i];
          const base64 = await fileToBase64(file);

          const img = new Image();
          img.src = base64;
          await img.decode();

          const imgWidth = img.width;
          const imgHeight = img.height;

          if (i === 0) {
            pdf = new jsPDF({
              orientation: imgWidth > imgHeight ? "l" : "p",
              unit: "px",
              format: [imgWidth, imgHeight],
            });
          } else {
            pdf.addPage([imgWidth, imgHeight], imgWidth > imgHeight ? "l" : "p");
          }

          pdf.addImage(base64, "PNG", 0, 0, imgWidth, imgHeight);
        }

        pdf.save("images-original-size.pdf");
      }

      function fileToBase64(file) {
        return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.onload = () => resolve(reader.result);
          reader.onerror = (error) => reject(error);
          reader.readAsDataURL(file);
        });
      }
    </script>
  </body>
</html>
